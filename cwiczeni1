CREATE SCHEMA cwiczenie1
CREATE TABLE Buildings (id INTEGER, geom GEOMETRY, name VARCHAR(50), height INTEGER);
CREATE TABLE Roads (id INT, geom GEOMETRY, name VARCHAR(50));
CREATE TABLE PointInfo (id INT, geom GEOMETRY, name VARCHAR(50), liczprac INT);

INSERT INTO PointInfo VALUES (1, ST_GeomFromText('POINT(1 3.5)', 0), 'G', 5);
INSERT INTO PointInfo VALUES (2, ST_GeomFromText('POINT(5.5 1.5)', 0), 'H', 4);
INSERT INTO PointInfo VALUES (3, ST_GeomFromText('POINT(9.5 6)', 0), 'I', 12);
INSERT INTO PointInfo VALUES (4, ST_GeomFromText('POINT(6.5 6)', 0), 'J', 1);
INSERT INTO PointInfo VALUES (5, ST_GeomFromText('POINT(6 9.5)', 0), 'K', 3);;
SELECT * FROM PointInfo

INSERT INTO Roads VALUES (1, ST_GeomFromText('LINESTRING(0 4.5, 12 4.5)', 0), 'RoadX');
INSERT INTO Roads VALUES (2, ST_GeomFromText('LINESTRING(7.5 10.5, 7.5 0)', 0), 'RoadY');
SELECT * FROM Roads

INSERT INTO Buildings VALUES (1, ST_GeomFromText('POLYGON((8 4, 10.5 4, 10.5 1.5, 8 1.5, 8 4))', 0), 'BuildingA', 13);
INSERT INTO Buildings VALUES (2, ST_GeomFromText('POLYGON((4 7, 6 7, 6 5, 4 5, 4 7))', 0), 'BuildingB', 5);
INSERT INTO Buildings VALUES (3, ST_GeomFromText('POLYGON((3 8, 5 8, 5 6, 3 6, 3 8))', 0), 'BuildingC', 25);
INSERT INTO Buildings VALUES (4, ST_GeomFromText('POLYGON((9 9, 10 9, 10 8, 9 8, 9 9))', 0), 'BuildingD', 15);
INSERT INTO Buildings VALUES (5, ST_GeomFromText('POLYGON((1 2, 2 2, 2 1, 1 1, 1 2))', 0), 'BuildingE', 10);
SELECT * FROM Buildings

/* Cwiczenie 1: Wyznacz całkowitą długość dróg w analizowanym mieście. */
SELECT SUM(ST_Length(geom)) FROM Roads

/* Cwiczenie 2: Wypisz geometrię (WKT), pole powierzchni oraz obwód poligonu reprezentującego BuildingA.  */
SELECT geom, ST_Area(geom), ST_Perimeter(geom) FROM Buildings WHERE name = 'BuildingA'

/* Cwiczenie 3: Wypisz nazwy i pola powierzchni wszystkich poligonów w warstwie budynki. Wyniki posortuj alfabetycznie.*/
SELECT name, ST_Area(geom) FROM Buildings ORDER BY name

/* Cwiczenie 4: Wypisz nazwy i obwody 2 budynków o największej powierzchni.  */
SELECT  name, ST_Perimeter(geom) FROM Buildings ORDER BY ST_Area(geom) DESC LIMIT 2

/* Cwiczenie 5: Wyznacz najkrótszą odległość między budynkiem BuildingC a punktem G. */
SELECT ST_Distance(b.geom, p.geom) AS Distance FROM Buildings as b, PointInfo as p
WHERE b.name = 'BuildingC' AND p.name = 'G'
/* Cwiczenie 6.Wypisz pole powierzchni tej części budynku BuildingC, która znajduje się w odległości większej niż 0.5 od budynku BuildingB.*/
SELECT ST_Area(ST_Difference((SELECT geom FROM Buildings WHERE name='BuildingC'), ST_Buffer(b.geom, 0.5))) FROM Buildings b WHERE b.name='BuildingB'



/* Cwiczenie 7: Wybierz te budynki, których centroid (ST_Centroid) znajduje siępowyżej drogi RoadX. */
SELECT name FROM Buildings b WHERE ST_Y(ST_Centroid(b.geom)) > ST_Y('POINT(0 4.5)') 


/*8.Oblicz pole powierzchni tych części budynku BuildingC i poligonu o współrzędnych (4 7, 6 7, 6 8, 4 8, 4 7), które nie sąwspólne dla tych dwóch obiektów. */
SELECT ST_Area((ST_SymDifference(geom,'POLYGON((4 7, 6 7, 6 8, 4 8, 4 7))'))) FROM Buildings WHERE name='BuildingC'
